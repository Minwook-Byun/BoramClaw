# BoramClaw Rules Engine - ìë™ ì•¡ì…˜ ê·œì¹™ ì •ì˜
# ì´ íŒŒì¼ì„ config/rules.yamlë¡œ ë³µì‚¬í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”.

# ê·œì¹™ í™œì„±í™” ì—¬ë¶€
enabled: true

# ê·œì¹™ ì²´í¬ ì£¼ê¸° (ì´ˆ)
check_interval: 300  # 5ë¶„ë§ˆë‹¤

# ê·œì¹™ ëª©ë¡
rules:
  # 1. ì»¤ë°‹ ì—†ì´ ì˜¤ë˜ ì‘ì—… ì‹œ ì•Œë¦¼
  - name: no_commit_reminder
    description: "3ì‹œê°„ ì´ìƒ ì½”ë”© ì¤‘ì´ì§€ë§Œ ì»¤ë°‹ì´ ì—†ì„ ë•Œ ì•Œë¦¼"
    enabled: true
    priority: high  # high, medium, low

    trigger:
      type: context_based
      conditions:
        - field: session.is_active
          operator: equals
          value: true
        - field: session.duration_minutes
          operator: greater_than
          value: 180  # 3ì‹œê°„
        - field: git.recent_commits
          operator: equals
          value: 0

    actions:
      - type: notification
        params:
          title: "ğŸ’¡ ì»¤ë°‹ ì•Œë¦¼"
          message: "3ì‹œê°„ì§¸ ì»¤ë°‹ì´ ì—†ìŠµë‹ˆë‹¤. ì‘ì—… ë‚´ìš©ì„ ì»¤ë°‹í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
          sound: "Glass"

      - type: log
        params:
          message: "no_commit_reminder triggered"
          level: "info"

  # 2. ì¥ì‹œê°„ ë¹„í™œë™ ì‹œ ì„¸ì…˜ ì¢…ë£Œ í™•ì¸
  - name: long_inactivity_check
    description: "30ë¶„ ì´ìƒ ë¹„í™œë™ ì‹œ ì„¸ì…˜ ì¢…ë£Œ í™•ì¸"
    enabled: true
    priority: medium

    trigger:
      type: inactivity
      conditions:
        - field: context.last_activity_minutes_ago
          operator: greater_than
          value: 30
        - field: session.was_active
          operator: equals
          value: true

    actions:
      - type: notification
        params:
          title: "ğŸ˜´ ì„¸ì…˜ ì¢…ë£Œ"
          message: "30ë¶„ê°„ í™œë™ì´ ì—†ìŠµë‹ˆë‹¤. ì‘ì—…ì´ ëë‚¬ë‚˜ìš”?"
          sound: "Tink"

      - type: tool_call
        params:
          tool_name: "workday_recap"
          tool_input:
            mode: "daily"

  # 3. ë°˜ë³µì ì¸ ëª…ë ¹ì–´ Alias ì¶”ì²œ
  - name: frequent_command_alias
    description: "5íšŒ ì´ìƒ ë°˜ë³µëœ ê¸´ ëª…ë ¹ì–´ì— Alias ì¶”ì²œ"
    enabled: true
    priority: low

    trigger:
      type: shell_pattern
      conditions:
        - field: shell.top_command_count
          operator: greater_than
          value: 5
        - field: shell.top_command_length
          operator: greater_than
          value: 30  # 30ì ì´ìƒ

    actions:
      - type: notification
        params:
          title: "âš¡ Alias ì¶”ì²œ"
          message: "ìì£¼ ì‚¬ìš©í•˜ëŠ” ê¸´ ëª…ë ¹ì–´ê°€ ìˆìŠµë‹ˆë‹¤. Aliasë¥¼ ë§Œë“œì‹œê² ìŠµë‹ˆê¹Œ?"
          sound: "Ping"

  # 4. ë¸Œë¼ìš°ì €ì—ì„œ ì˜¤ë˜ ë¦¬ì„œì¹˜ ì¤‘ì¼ ë•Œ
  - name: research_to_coding_reminder
    description: "1ì‹œê°„ ì´ìƒ ë¸Œë¼ìš°ì € ë¦¬ì„œì¹˜ ì¤‘ì¼ ë•Œ ì½”ë”© ì‹œì‘ ê¶Œì¥"
    enabled: true
    priority: medium

    trigger:
      type: context_based
      conditions:
        - field: context.primary_activity
          operator: equals
          value: "research"
        - field: session.duration_minutes
          operator: greater_than
          value: 60
        - field: shell.recent_coding_commands
          operator: equals
          value: 0

    actions:
      - type: notification
        params:
          title: "ğŸ’» ì½”ë”© ì‹œì‘"
          message: "1ì‹œê°„ì§¸ ë¦¬ì„œì¹˜ ì¤‘ì…ë‹ˆë‹¤. ì½”ë”©ì„ ì‹œì‘í•´ë³¼ê¹Œìš”?"
          sound: "Hero"

  # 5. ë§¤ì¼ ì˜¤í›„ 9ì‹œ ì¼ì¼ ë¦¬í¬íŠ¸
  - name: daily_recap_9pm
    description: "ë§¤ì¼ ì˜¤í›„ 9ì‹œì— ì¼ì¼ ë¦¬í¬íŠ¸ ìë™ ìƒì„±"
    enabled: true
    priority: high

    trigger:
      type: time_based
      schedule:
        time: "21:00"
        days: ["mon", "tue", "wed", "thu", "fri", "sat", "sun"]

    actions:
      - type: tool_call
        params:
          tool_name: "daily_recap_notifier"
          tool_input: {}

  # 6. í”„ë¡œì íŠ¸ ì „í™˜ ê°ì§€
  - name: project_switch_detection
    description: "í”„ë¡œì íŠ¸ ì „í™˜ ì‹œ ì´ì „ í”„ë¡œì íŠ¸ ì»¤ë°‹ í™•ì¸"
    enabled: false  # ì‹¤í—˜ì  ê¸°ëŠ¥
    priority: medium

    trigger:
      type: context_change
      conditions:
        - field: git.repo_changed
          operator: equals
          value: true
        - field: git.previous_repo_uncommitted_changes
          operator: equals
          value: true

    actions:
      - type: notification
        params:
          title: "ğŸ”„ í”„ë¡œì íŠ¸ ì „í™˜"
          message: "ì´ì „ í”„ë¡œì íŠ¸ì— ì»¤ë°‹í•˜ì§€ ì•Šì€ ë³€ê²½ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤."
          sound: "Sosumi"

  # 7. ì§‘ì¤‘ ì‹œê°„ ì¶”ì 
  - name: focus_time_tracker
    description: "2ì‹œê°„ ì§‘ì¤‘ ì‘ì—… í›„ íœ´ì‹ ê¶Œì¥"
    enabled: true
    priority: medium

    trigger:
      type: context_based
      conditions:
        - field: session.is_active
          operator: equals
          value: true
        - field: session.duration_minutes
          operator: greater_than
          value: 120
        - field: session.last_break_minutes_ago
          operator: greater_than
          value: 120

    actions:
      - type: notification
        params:
          title: "â˜• íœ´ì‹ ì‹œê°„"
          message: "2ì‹œê°„ì§¸ ì‘ì—… ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ íœ´ì‹í•˜ì„¸ìš”!"
          sound: "Glass"

  # 8. ì‹¬ì•¼ ì‘ì—… ì•Œë¦¼
  - name: late_night_warning
    description: "ìƒˆë²½ 2ì‹œ ì´í›„ ì‘ì—… ì‹œ ìˆ˜ë©´ ê¶Œì¥"
    enabled: true
    priority: high

    trigger:
      type: time_based
      schedule:
        time: "02:00"
        condition: session_active

    actions:
      - type: notification
        params:
          title: "ğŸŒ™ ìˆ˜ë©´ ê¶Œì¥"
          message: "ìƒˆë²½ 2ì‹œì…ë‹ˆë‹¤. ë‚´ì¼ì„ ìœ„í•´ íœ´ì‹í•˜ì„¸ìš”."
          sound: "Submarine"

# ì¡°ê±´ ì—°ì‚°ì:
# - equals: ê°™ìŒ
# - not_equals: ë‹¤ë¦„
# - greater_than: ì´ˆê³¼
# - less_than: ë¯¸ë§Œ
# - greater_than_or_equal: ì´ìƒ
# - less_than_or_equal: ì´í•˜
# - contains: í¬í•¨
# - not_contains: ë¶ˆí¬í•¨

# ì•¡ì…˜ íƒ€ì…:
# - notification: macOS ì•Œë¦¼
# - tool_call: BoramClaw íˆ´ ì‹¤í–‰
# - log: ë¡œê·¸ ê¸°ë¡
# - shell: Shell ëª…ë ¹ ì‹¤í–‰
# - webhook: Webhook í˜¸ì¶œ

# ìš°ì„ ìˆœìœ„:
# - high: ì¦‰ì‹œ ì‹¤í–‰
# - medium: ë‹¤ìŒ ì²´í¬ ì£¼ê¸°ì— ì‹¤í–‰
# - low: ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
